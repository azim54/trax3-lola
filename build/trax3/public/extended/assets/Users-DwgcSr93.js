import{_ as H}from"./AccessLayout-C1y39Yor.js";import{f as U,g as K,h as Q,o as l,c as d,d as s,u as o,w as p,F as C,Z as X,a as r,e as g,i as F,t as I,b as v,j as m,k as L}from"./app-BqYB4w7h.js";import{_ as N}from"./PrimaryButton-JrsBxlP3.js";import{r as Y,a as ee}from"./FormModal--OgS4LYv.js";import{r as te,_ as oe}from"./ConfirmModal-DdIInXQ7.js";import{_ as y}from"./InputLabel-B012P3ON.js";import{_ as h}from"./TextInput-Bd33mpYb.js";import{_ as re}from"./SearchInput-AQKiP9nK.js";import{_ as se}from"./Checkbox-CesKyGxn.js";import{_ as ae}from"./AgentFilter-Bzph49mo.js";import{W as le}from"./WarningBadge-D1JWfst3.js";import{N as ie}from"./NeutralBadge-Cx27iNjU.js";import{u as ne}from"./CrudItems-BFkrHaNx.js";import{_ as de}from"./ScrollToTop-jtdKJjCK.js";import{u as me}from"./FilterItems-DtKLW4qf.js";import{_ as O}from"./Select-I1X3nauV.js";import{r as ue}from"./PencilSquareIcon-CqSWVHZD.js";import"./AuthenticatedLayout-DmkbqqwL.js";import"./TopBar-CSycyVTE.js";import"./ApplicationLogo-CbRF8qXe.js";import"./form-BD1T68Go.js";import"./use-resolve-button-type-zbaL4VAc.js";import"./calculate-active-index-CJPhqQS-.js";import"./use-text-value-5zAQL0RU.js";import"./use-tree-walker-CEHhLUFs.js";import"./transition-CSxLRhS2.js";import"./disposables-CuHKeC00.js";import"./InputError-_zuJ5dV-.js";import"./AgentField-Cckzi0Yd.js";import"./ChevronUpDownIcon-BxOM5Ujt.js";import"./TextInputWithCompletion-u-xIqChF.js";import"./StoreSelector-eCG8qd9a.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./LoadItems-f7CjgfCr.js";import"./ChevronUpIcon-CDU9mihh.js";const pe={class:"rounded-lg shadow-md bg-white dark:ring-0 dark:bg-gray-800"},ce={class:"p-5 border-b-2 border-gray-200 dark:border-gray-700"},fe={class:"-ml-4 -mt-2 flex flex-wrap items-center justify-between sm:flex-nowrap"},ge=r("div",{class:"ml-4 mt-2 max-w-lg"},[r("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-gray-100"}," User Accounts "),r("p",{class:"mt-1 text-sm text-gray-500"}," Create and configure user accounts in order to give access to the LRS application. ")],-1),ye={class:"ml-4 mt-2 flex-shrink-0"},_e={class:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4 mt-3"},xe={class:"relative flex flex-row"},ve={class:"relative flex flex-row"},he={key:0,class:"table-auto min-w-full divide-y divide-gray-300 dark:divide-gray-500"},ke={class:"divide-y divide-gray-200 dark:divide-gray-700"},Ve={class:"px-5 py-3"},we={class:"text-sm font-medium text-gray-900 dark:text-gray-300"},be={class:"px-5 py-3"},Ae={class:"text-sm text-gray-900 dark:text-white"},Ue={class:"px-5 py-3"},Ce={class:"text-sm dark:font-thin text-gray-500 dark:text-white capitalize"},Ie={class:"px-5 py-3"},$e={class:"flex space-x-4 justify-end items-center"},Pe={key:1,class:"px-5 py-3 text-sm text-gray-500 dark:text-gray-400"},Se={key:2,class:"px-5 py-3 text-sm text-gray-500 dark:text-gray-400"},Fe={key:3,class:"text-center pt-6 pb-6"},Le={class:"px-6"},Ne={class:"mt-5 px-6"},Oe={class:"mt-5 px-6"},je={class:"mt-5 px-6"},Be=r("p",{class:"pl-1 pt-1 text-sm text-orange-600 dark:text-orange-400"}," Remember it. It will never be revealed here. ",-1),Me={class:"mt-5 px-6"},De={class:"mt-5 px-6"},Ee={key:0},Re=r("div",{class:"mt-8 px-6 font-medium dark:text-white"}," Accessible stores ",-1),wt={__name:"Users",props:{auth:{type:Object,required:!0}},setup(k){const a=U({id:null,firstname:null,lastname:null,email:null,password:null,agent:null,role:"actor",stores:{}}),_=K([]),j=i=>new Promise((t,e)=>{axios.get("/trax/api/gateway/front/stores").then(u=>{_.value=u.data.data.filter(A=>A.status==="ready"),t()})}),B=(i,t)=>t=="agent"?JSON.parse(i.agent):i[t]===void 0?null:i[t],M=(i,t)=>{if(t=="agent"&&i.agent)return JSON.stringify(i.agent);if(t=="stores"&&Object.keys(i.stores).length===0){let e=_.value[0].slug,u={};return u[e]=!1,u}return i[t]},$=[{id:"actor",name:"Actor"},{id:"analyst",name:"Data Analyst"},{id:"manager",name:"Data Manager"},{id:"supervisor",name:"Supervisor"},{id:"admin",name:"Admin"}],D=Q(()=>{let i=[...$];return i.unshift({id:null,name:"All roles"}),i}),c=U({search:null,role:null}),E=U({}),{loadItems:R,loadMoreItems:W,loadedItems:V,loadedCounter:J,hasMoreItems:T,loadingItems:x,createItem:q,updateItem:z,confirmCreateOrUpdateItem:f,deleteItem:Z,confirmDeleteItem:G,isProcessingItem:P,itemFormVisible:w,deleteItemModalVisible:b,itemFormErrors:n}=ne({url:"/trax/api/gateway/front/users",filters:c,baseParams:{},settings:{sortProp:"email",ascending:!0,more:!0,autoload:!1}},a,{beforeItemLoading:j,afterPropLoading:B,beforePropPosting:M}),{applyFilters:S}=me({filters:c,options:E,counter:J},{localStorage:"user-filters",callback:R});return(i,t)=>(l(),d(C,null,[s(o(X),{title:"User Accounts"}),s(H,{"side-menu-current":"Accounts"},{default:p(()=>[r("div",pe,[r("div",ce,[r("div",fe,[ge,r("div",ye,[s(N,{onClick:o(q),class:"flex"},{default:p(()=>[s(o(Y),{class:"w-5 h-5 mr-2"}),g(" User ")]),_:1},8,["onClick"])])]),r("div",_e,[r("div",xe,[s(re,{id:"search",placeholder:"Search...",modelValue:c.search,"onUpdate:modelValue":t[0]||(t[0]=e=>c.search=e),onApply:o(S)},null,8,["modelValue","onApply"])]),r("div",ve,[s(O,{id:"role_filter",options:D.value,modelValue:c.role,"onUpdate:modelValue":[t[1]||(t[1]=e=>c.role=e),t[2]||(t[2]=e=>o(S)())]},null,8,["options","modelValue"])])])]),!o(x)&&o(V).length>0?(l(),d("table",he,[r("tbody",ke,[(l(!0),d(C,null,F(o(V),(e,u)=>(l(),d("tr",{key:u},[r("td",Ve,[r("div",we,[g(I(e.fullname)+" ",1),k.auth.id===e.id?(l(),v(ie,{key:0,class:"ml-1"},{default:p(()=>[g("Me")]),_:1})):m("",!0),e.role==="admin"?(l(),v(le,{key:1,class:"ml-1"},{default:p(()=>[g("Admin")]),_:1})):m("",!0)])]),r("td",be,[r("div",Ae,I(e.email),1)]),r("td",Ue,[r("div",Ce,I(e.role),1)]),r("td",Ie,[r("div",$e,[k.auth.id!==e.id?(l(),v(o(ue),{key:0,class:"w-5 h-5 hover:cursor-pointer text-indigo-500 hover:text-indigo-700 dark:text-fuchsia-400 dark:hover:text-fuchsia-500",onClick:A=>o(z)(e)},null,8,["onClick"])):m("",!0),k.auth.id!==e.id?(l(),v(o(te),{key:1,class:"w-5 h-5 hover:cursor-pointer text-indigo-500 hover:text-indigo-700 dark:text-fuchsia-400 dark:hover:text-fuchsia-500",onClick:A=>o(Z)(e)},null,8,["onClick"])):m("",!0)])])]))),128))])])):m("",!0),!o(x)&&o(V).length==0?(l(),d("div",Pe," There is currently no user matching with your search criteria. ")):m("",!0),o(x)?(l(),d("div",Se," Loading... ")):m("",!0),o(T)?(l(),d("div",Fe,[s(N,{processing:o(x),onClick:o(W)},{default:p(()=>[g(" Load More ")]),_:1},8,["processing","onClick"])])):m("",!0),s(de),s(ee,{title:"User Account",processing:o(P),modelValue:o(w),"onUpdate:modelValue":t[14]||(t[14]=e=>L(w)?w.value=e:null),onConfirm:o(f)},{default:p(()=>[r("div",Le,[s(y,{for:"firstname",value:"Firstname"}),s(h,{id:"firstname",placeholder:"Firstname",modelValue:a.firstname,"onUpdate:modelValue":t[3]||(t[3]=e=>a.firstname=e),error:o(n).firstname,"onUpdate:error":t[4]||(t[4]=e=>o(n).firstname=e),onApply:o(f),class:"mt-1"},null,8,["modelValue","error","onApply"])]),r("div",Ne,[s(y,{for:"lastname",value:"Lastname"}),s(h,{id:"lastname",placeholder:"Lastname",modelValue:a.lastname,"onUpdate:modelValue":t[5]||(t[5]=e=>a.lastname=e),error:o(n).lastname,"onUpdate:error":t[6]||(t[6]=e=>o(n).lastname=e),onApply:o(f),class:"mt-1"},null,8,["modelValue","error","onApply"])]),r("div",Oe,[s(y,{for:"email",value:"Email"}),s(h,{id:"email",placeholder:"Email",modelValue:a.email,"onUpdate:modelValue":t[7]||(t[7]=e=>a.email=e),error:o(n).email,"onUpdate:error":t[8]||(t[8]=e=>o(n).email=e),onApply:o(f),class:"mt-1",type:"email"},null,8,["modelValue","error","onApply"])]),r("div",je,[s(y,{for:"password",value:"Password"}),s(h,{id:"password",placeholder:a.id?"Only if you want to change it":"Password",modelValue:a.password,"onUpdate:modelValue":t[9]||(t[9]=e=>a.password=e),error:o(n).password,"onUpdate:error":t[10]||(t[10]=e=>o(n).password=e),onApply:o(f),class:"mt-1",type:"password"},null,8,["placeholder","modelValue","error","onApply"]),Be]),r("div",Me,[s(ae,{modelValue:a.agent,"onUpdate:modelValue":t[11]||(t[11]=e=>a.agent=e),error:o(n).agent,"onUpdate:error":t[12]||(t[12]=e=>o(n).agent=e),onApply:o(f),inline:!1},null,8,["modelValue","error","onApply"])]),r("div",De,[s(y,{for:"role",value:"Role"}),s(O,{id:"role",options:$,modelValue:a.role,"onUpdate:modelValue":t[13]||(t[13]=e=>a.role=e),class:"mt-1"},null,8,["modelValue"])]),(a.role=="actor"||a.role=="analyst")&&_.value.length>0?(l(),d("div",Ee,[Re,(l(!0),d(C,null,F(_.value,e=>(l(),d("div",{class:"mt-5 px-6",key:e.id},[s(se,{id:e.slug,label:e.name,modelValue:a.stores[e.id],"onUpdate:modelValue":u=>a.stores[e.id]=u},null,8,["id","label","modelValue","onUpdate:modelValue"])]))),128))])):m("",!0)]),_:1},8,["processing","modelValue","onConfirm"]),s(oe,{title:"Delete user",processing:o(P),modelValue:o(b),"onUpdate:modelValue":t[15]||(t[15]=e=>L(b)?b.value=e:null),onConfirm:o(G)},{default:p(()=>[g(" Are you sure you want to delete this user? ")]),_:1},8,["processing","modelValue","onConfirm"])])]),_:1})],64))}};export{wt as default};
