import{d as Q,u as P,o as g,e as Z,f as _,E as G,s as W,A as C,T as J,I as F,N as z,a as p}from"./form-BD1T68Go.js";import{f as X,e as O,b as Y,g as $,h as ee,d as te,a as V,l as le,u as ae,O as oe}from"./calculate-active-index-CJPhqQS-.js";import{s as ne}from"./use-resolve-button-type-zbaL4VAc.js";import{p as ie}from"./use-text-value-5zAQL0RU.js";import{B as E,g as L,h as b,L as y,G as ue,m as M,s as K,D as U,F as re,C as se,A as de,K as A,H as ve,o as pe,c as ce,a as fe}from"./app-BqYB4w7h.js";function be(t,m){return t===m}var me=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(me||{}),xe=(t=>(t[t.Single=0]="Single",t[t.Multi=1]="Multi",t))(xe||{}),ge=(t=>(t[t.Pointer=0]="Pointer",t[t.Other=1]="Other",t))(ge||{});function Oe(t){requestAnimationFrame(()=>requestAnimationFrame(t))}let H=Symbol("ListboxContext");function j(t){let m=ve(H,null);if(m===null){let h=new Error(`<${t} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(h,j),h}return m}let we=E({name:"Listbox",emits:{"update:modelValue":t=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>be},horizontal:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(t,{slots:m,attrs:h,emit:D}){let r=L(1),c=L(null),e=L(null),f=L(null),s=L([]),d=L(""),v=L(null),a=L(1);function n(l=o=>o){let o=v.value!==null?s.value[v.value]:null,i=oe(l(s.value.slice()),x=>g(x.dataRef.domRef)),u=o?i.indexOf(o):null;return u===-1&&(u=null),{options:i,activeOptionIndex:u}}let R=b(()=>t.multiple?1:0),[w,S]=Q(b(()=>t.modelValue),l=>D("update:modelValue",l),b(()=>t.defaultValue)),T=b(()=>w.value===void 0?P(R.value,{1:[],0:void 0}):w.value),k={listboxState:r,value:T,mode:R,compare(l,o){if(typeof t.by=="string"){let i=t.by;return(l==null?void 0:l[i])===(o==null?void 0:o[i])}return t.by(l,o)},orientation:b(()=>t.horizontal?"horizontal":"vertical"),labelRef:c,buttonRef:e,optionsRef:f,disabled:b(()=>t.disabled),options:s,searchQuery:d,activeOptionIndex:v,activationTrigger:a,closeListbox(){t.disabled||r.value!==1&&(r.value=1,v.value=null)},openListbox(){t.disabled||r.value!==0&&(r.value=0)},goToOption(l,o,i){if(t.disabled||r.value===1)return;let u=n(),x=X(l===O.Specific?{focus:O.Specific,id:o}:{focus:l},{resolveItems:()=>u.options,resolveActiveIndex:()=>u.activeOptionIndex,resolveId:B=>B.id,resolveDisabled:B=>B.dataRef.disabled});d.value="",v.value=x,a.value=i??1,s.value=u.options},search(l){if(t.disabled||r.value===1)return;let o=d.value!==""?0:1;d.value+=l.toLowerCase();let i=(v.value!==null?s.value.slice(v.value+o).concat(s.value.slice(0,v.value+o)):s.value).find(x=>x.dataRef.textValue.startsWith(d.value)&&!x.dataRef.disabled),u=i?s.value.indexOf(i):-1;u===-1||u===v.value||(v.value=u,a.value=1)},clearSearch(){t.disabled||r.value!==1&&d.value!==""&&(d.value="")},registerOption(l,o){let i=n(u=>[...u,{id:l,dataRef:o}]);s.value=i.options,v.value=i.activeOptionIndex},unregisterOption(l){let o=n(i=>{let u=i.findIndex(x=>x.id===l);return u!==-1&&i.splice(u,1),i});s.value=o.options,v.value=o.activeOptionIndex,a.value=1},theirOnChange(l){t.disabled||S(l)},select(l){t.disabled||S(P(R.value,{0:()=>l,1:()=>{let o=y(k.value.value).slice(),i=y(l),u=o.findIndex(x=>k.compare(i,y(x)));return u===-1?o.push(i):o.splice(u,1),o}}))}};Y([e,f],(l,o)=>{var i;k.closeListbox(),$(o,ee.Loose)||(l.preventDefault(),(i=g(e))==null||i.focus())},b(()=>r.value===0)),ue(H,k),te(b(()=>P(r.value,{0:V.Open,1:V.Closed})));let I=b(()=>{var l;return(l=g(e))==null?void 0:l.closest("form")});return M(()=>{K([I],()=>{if(!I.value||t.defaultValue===void 0)return;function l(){k.theirOnChange(t.defaultValue)}return I.value.addEventListener("reset",l),()=>{var o;(o=I.value)==null||o.removeEventListener("reset",l)}},{immediate:!0})}),()=>{let{name:l,modelValue:o,disabled:i,form:u,...x}=t,B={open:r.value===0,disabled:i,value:T.value};return U(re,[...l!=null&&T.value!=null?Z({[l]:T.value}).map(([N,q])=>U(_,G({features:W.Hidden,key:N,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:u,name:N,value:q}))):[],C({ourProps:{},theirProps:{...h,...J(x,["defaultValue","onUpdate:modelValue","horizontal","multiple","by"])},slot:B,slots:m,attrs:h,name:"Listbox"})])}}}),ke=E({name:"ListboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(t,{attrs:m,slots:h,expose:D}){var r;let c=(r=t.id)!=null?r:`headlessui-listbox-button-${F()}`,e=j("ListboxButton");D({el:e.buttonRef,$el:e.buttonRef});function f(a){switch(a.key){case p.Space:case p.Enter:case p.ArrowDown:a.preventDefault(),e.openListbox(),A(()=>{var n;(n=g(e.optionsRef))==null||n.focus({preventScroll:!0}),e.value.value||e.goToOption(O.First)});break;case p.ArrowUp:a.preventDefault(),e.openListbox(),A(()=>{var n;(n=g(e.optionsRef))==null||n.focus({preventScroll:!0}),e.value.value||e.goToOption(O.Last)});break}}function s(a){switch(a.key){case p.Space:a.preventDefault();break}}function d(a){e.disabled.value||(e.listboxState.value===0?(e.closeListbox(),A(()=>{var n;return(n=g(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})})):(a.preventDefault(),e.openListbox(),Oe(()=>{var n;return(n=g(e.optionsRef))==null?void 0:n.focus({preventScroll:!0})})))}let v=ne(b(()=>({as:t.as,type:m.type})),e.buttonRef);return()=>{var a,n;let R={open:e.listboxState.value===0,disabled:e.disabled.value,value:e.value.value},{...w}=t,S={ref:e.buttonRef,id:c,type:v.value,"aria-haspopup":"listbox","aria-controls":(a=g(e.optionsRef))==null?void 0:a.id,"aria-expanded":e.listboxState.value===0,"aria-labelledby":e.labelRef.value?[(n=g(e.labelRef))==null?void 0:n.id,c].join(" "):void 0,disabled:e.disabled.value===!0?!0:void 0,onKeydown:f,onKeyup:s,onClick:d};return C({ourProps:S,theirProps:w,slot:R,attrs:m,slots:h,name:"ListboxButton"})}}}),Pe=E({name:"ListboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(t,{attrs:m,slots:h,expose:D}){var r;let c=(r=t.id)!=null?r:`headlessui-listbox-options-${F()}`,e=j("ListboxOptions"),f=L(null);D({el:e.optionsRef,$el:e.optionsRef});function s(a){switch(f.value&&clearTimeout(f.value),a.key){case p.Space:if(e.searchQuery.value!=="")return a.preventDefault(),a.stopPropagation(),e.search(a.key);case p.Enter:if(a.preventDefault(),a.stopPropagation(),e.activeOptionIndex.value!==null){let n=e.options.value[e.activeOptionIndex.value];e.select(n.dataRef.value)}e.mode.value===0&&(e.closeListbox(),A(()=>{var n;return(n=g(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})}));break;case P(e.orientation.value,{vertical:p.ArrowDown,horizontal:p.ArrowRight}):return a.preventDefault(),a.stopPropagation(),e.goToOption(O.Next);case P(e.orientation.value,{vertical:p.ArrowUp,horizontal:p.ArrowLeft}):return a.preventDefault(),a.stopPropagation(),e.goToOption(O.Previous);case p.Home:case p.PageUp:return a.preventDefault(),a.stopPropagation(),e.goToOption(O.First);case p.End:case p.PageDown:return a.preventDefault(),a.stopPropagation(),e.goToOption(O.Last);case p.Escape:a.preventDefault(),a.stopPropagation(),e.closeListbox(),A(()=>{var n;return(n=g(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})});break;case p.Tab:a.preventDefault(),a.stopPropagation();break;default:a.key.length===1&&(e.search(a.key),f.value=setTimeout(()=>e.clearSearch(),350));break}}let d=le(),v=b(()=>d!==null?(d.value&V.Open)===V.Open:e.listboxState.value===0);return()=>{var a,n;let R={open:e.listboxState.value===0},{...w}=t,S={"aria-activedescendant":e.activeOptionIndex.value===null||(a=e.options.value[e.activeOptionIndex.value])==null?void 0:a.id,"aria-multiselectable":e.mode.value===1?!0:void 0,"aria-labelledby":(n=g(e.buttonRef))==null?void 0:n.id,"aria-orientation":e.orientation.value,id:c,onKeydown:s,role:"listbox",tabIndex:0,ref:e.optionsRef};return C({ourProps:S,theirProps:w,slot:R,attrs:m,slots:h,features:z.RenderStrategy|z.Static,visible:v.value,name:"ListboxOptions"})}}}),De=E({name:"ListboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(t,{slots:m,attrs:h,expose:D}){var r;let c=(r=t.id)!=null?r:`headlessui-listbox-option-${F()}`,e=j("ListboxOption"),f=L(null);D({el:f,$el:f});let s=b(()=>e.activeOptionIndex.value!==null?e.options.value[e.activeOptionIndex.value].id===c:!1),d=b(()=>P(e.mode.value,{0:()=>e.compare(y(e.value.value),y(t.value)),1:()=>y(e.value.value).some(l=>e.compare(y(l),y(t.value)))})),v=b(()=>P(e.mode.value,{1:()=>{var l;let o=y(e.value.value);return((l=e.options.value.find(i=>o.some(u=>e.compare(y(u),y(i.dataRef.value)))))==null?void 0:l.id)===c},0:()=>d.value})),a=ie(f),n=b(()=>({disabled:t.disabled,value:t.value,get textValue(){return a()},domRef:f}));M(()=>e.registerOption(c,n)),se(()=>e.unregisterOption(c)),M(()=>{K([e.listboxState,d],()=>{e.listboxState.value===0&&d.value&&P(e.mode.value,{1:()=>{v.value&&e.goToOption(O.Specific,c)},0:()=>{e.goToOption(O.Specific,c)}})},{immediate:!0})}),de(()=>{e.listboxState.value===0&&s.value&&e.activationTrigger.value!==0&&A(()=>{var l,o;return(o=(l=g(f))==null?void 0:l.scrollIntoView)==null?void 0:o.call(l,{block:"nearest"})})});function R(l){if(t.disabled)return l.preventDefault();e.select(t.value),e.mode.value===0&&(e.closeListbox(),A(()=>{var o;return(o=g(e.buttonRef))==null?void 0:o.focus({preventScroll:!0})}))}function w(){if(t.disabled)return e.goToOption(O.Nothing);e.goToOption(O.Specific,c)}let S=ae();function T(l){S.update(l)}function k(l){S.wasMoved(l)&&(t.disabled||s.value||e.goToOption(O.Specific,c,0))}function I(l){S.wasMoved(l)&&(t.disabled||s.value&&e.goToOption(O.Nothing))}return()=>{let{disabled:l}=t,o={active:s.value,selected:d.value,disabled:l},{value:i,disabled:u,...x}=t,B={id:c,ref:f,role:"option",tabIndex:l===!0?void 0:-1,"aria-disabled":l===!0?!0:void 0,"aria-selected":d.value,disabled:void 0,onClick:R,onFocus:w,onPointerenter:T,onMouseenter:T,onPointermove:k,onMousemove:k,onPointerleave:I,onMouseleave:I};return C({ourProps:B,theirProps:x,slot:o,attrs:h,slots:m,name:"ListboxOption"})}}});function Te(t,m){return pe(),ce("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[fe("path",{"fill-rule":"evenodd",d:"M10.53 3.47a.75.75 0 0 0-1.06 0L6.22 6.72a.75.75 0 0 0 1.06 1.06L10 5.06l2.72 2.72a.75.75 0 1 0 1.06-1.06l-3.25-3.25Zm-4.31 9.81 3.25 3.25a.75.75 0 0 0 1.06 0l3.25-3.25a.75.75 0 1 0-1.06-1.06L10 14.94l-2.72-2.72a.75.75 0 0 0-1.06 1.06Z","clip-rule":"evenodd"})])}export{Pe as A,De as F,we as I,ke as j,Te as r};
