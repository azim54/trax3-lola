import{_ as ve}from"./InputError-_zuJ5dV-.js";import{h as y,u as S,E as Me,s as j,N as fe,O as ze,B as G,g as V,f as Pe,L,G as Oe,m as ue,D as ee,F as re,A as te,H as Ce,C as Ve,K as Ee,M as Fe,o as B,c as Z,a as q,t as ie,d as Q,w as K,b as _,i as me,n as U,j as X,k as he}from"./app-BqYB4w7h.js";import{d as $e,u as W,o as T,e as De,f as Ae,E as Be,s as Ne,A as oe,T as de,I as ce,N as le,a as N}from"./form-BD1T68Go.js";import{e as F,f as pe,b as je,d as Le,a as ne,i as qe,l as Ke,u as _e,O as Ue,n as He}from"./calculate-active-index-CJPhqQS-.js";import{i as We}from"./use-tree-walker-CEHhLUFs.js";import{o as ge,a as be}from"./disposables-CuHKeC00.js";function H(n,u,e){let o=e.initialDeps??[],t;return()=>{var a,r,l,f;let h;e.key&&((a=e.debug)!=null&&a.call(e))&&(h=Date.now());const p=n();if(!(p.length!==o.length||p.some((C,R)=>o[R]!==C)))return t;o=p;let d;if(e.key&&((r=e.debug)!=null&&r.call(e))&&(d=Date.now()),t=u(...p),e.key&&((l=e.debug)!=null&&l.call(e))){const C=Math.round((Date.now()-h)*100)/100,R=Math.round((Date.now()-d)*100)/100,M=R/16,D=(g,I)=>{for(g=String(g);g.length<I;)g=" "+g;return g};console.info(`%c⏱ ${D(R,5)} /${D(C,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*M,120))}deg 100% 31%);`,e==null?void 0:e.key)}return(f=e==null?void 0:e.onChange)==null||f.call(e,t),t}}function se(n,u){if(n===void 0)throw new Error(`Unexpected undefined${u?`: ${u}`:""}`);return n}const Je=(n,u)=>Math.abs(n-u)<1,Ge=n=>n,Ye=n=>{const u=Math.max(n.startIndex-n.overscan,0),e=Math.min(n.endIndex+n.overscan,n.count-1),o=[];for(let t=u;t<=e;t++)o.push(t);return o},Ze=(n,u)=>{const e=n.scrollElement;if(!e)return;const o=a=>{const{width:r,height:l}=a;u({width:Math.round(r),height:Math.round(l)})};if(o(e.getBoundingClientRect()),typeof ResizeObserver>"u")return()=>{};const t=new ResizeObserver(a=>{const r=a[0];if(r!=null&&r.borderBoxSize){const l=r.borderBoxSize[0];if(l){o({width:l.inlineSize,height:l.blockSize});return}}o(e.getBoundingClientRect())});return t.observe(e,{box:"border-box"}),()=>{t.unobserve(e)}},Qe=(n,u)=>{const e=n.scrollElement;if(!e)return;const o=()=>{u(e[n.options.horizontal?"scrollLeft":"scrollTop"])};return o(),e.addEventListener("scroll",o,{passive:!0}),()=>{e.removeEventListener("scroll",o)}},Xe=(n,u,e)=>{if(u!=null&&u.borderBoxSize){const o=u.borderBoxSize[0];if(o)return Math.round(o[e.options.horizontal?"inlineSize":"blockSize"])}return Math.round(n.getBoundingClientRect()[e.options.horizontal?"width":"height"])},et=(n,{adjustments:u=0,behavior:e},o)=>{var t,a;const r=n+u;(a=(t=o.scrollElement)==null?void 0:t.scrollTo)==null||a.call(t,{[o.options.horizontal?"left":"top"]:r,behavior:e})};class tt{constructor(u){this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.isScrollingTimeoutId=null,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(()=>{let e=null;const o=()=>e||(typeof ResizeObserver<"u"?e=new ResizeObserver(t=>{t.forEach(a=>{this._measureElement(a.target,a)})}):null);return{disconnect:()=>{var t;return(t=o())==null?void 0:t.disconnect()},observe:t=>{var a;return(a=o())==null?void 0:a.observe(t,{box:"border-box"})},unobserve:t=>{var a;return(a=o())==null?void 0:a.unobserve(t)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([o,t])=>{typeof t>"u"&&delete e[o]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Ge,rangeExtractor:Ye,onChange:()=>{},measureElement:Xe,initialRect:{width:0,height:0},scrollMargin:0,scrollingDelay:150,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,...e}},this.notify=e=>{var o,t;(t=(o=this.options).onChange)==null||t.call(o,this,e)},this.maybeNotify=H(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.scrollElement=null},this._didMount=()=>(this.measureElementCache.forEach(this.observer.observe),()=>{this.observer.disconnect(),this.cleanup()}),this._willUpdate=()=>{const e=this.options.getScrollElement();this.scrollElement!==e&&(this.cleanup(),this.scrollElement=e,this._scrollToOffset(this.scrollOffset,{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,o=>{this.scrollRect=o,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,o=>{this.scrollAdjustments=0,this.scrollOffset!==o&&(this.isScrollingTimeoutId!==null&&(clearTimeout(this.isScrollingTimeoutId),this.isScrollingTimeoutId=null),this.isScrolling=!0,this.scrollDirection=this.scrollOffset<o?"forward":"backward",this.scrollOffset=o,this.maybeNotify(),this.isScrollingTimeoutId=setTimeout(()=>{this.isScrollingTimeoutId=null,this.isScrolling=!1,this.scrollDirection=null,this.maybeNotify()},this.options.scrollingDelay))})))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.memoOptions=H(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey],(e,o,t,a)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:o,scrollMargin:t,getItemKey:a}),{key:!1}),this.getFurthestMeasurement=(e,o)=>{const t=new Map,a=new Map;for(let r=o-1;r>=0;r--){const l=e[r];if(t.has(l.lane))continue;const f=a.get(l.lane);if(f==null||l.end>f.end?a.set(l.lane,l):l.end<f.end&&t.set(l.lane,!0),t.size===this.options.lanes)break}return a.size===this.options.lanes?Array.from(a.values()).sort((r,l)=>r.end===l.end?r.index-l.index:r.end-l.end)[0]:void 0},this.getMeasurements=H(()=>[this.memoOptions(),this.itemSizeCache],({count:e,paddingStart:o,scrollMargin:t,getItemKey:a},r)=>{const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const f=this.measurementsCache.slice(0,l);for(let h=l;h<e;h++){const p=a(h),m=this.options.lanes===1?f[h-1]:this.getFurthestMeasurement(f,h),d=m?m.end:o+t,C=r.get(p),R=typeof C=="number"?C:this.options.estimateSize(h),M=d+R,D=m?m.lane:h%this.options.lanes;f[h]={index:h,start:d,size:R,end:M,key:p,lane:D}}return this.measurementsCache=f,f},{key:!1,debug:()=>this.options.debug}),this.calculateRange=H(()=>[this.getMeasurements(),this.getSize(),this.scrollOffset],(e,o,t)=>this.range=e.length>0&&o>0?lt({measurements:e,outerSize:o,scrollOffset:t}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=H(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(e,o,t,a)=>o===null?[]:e({...o,overscan:t,count:a}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const o=this.options.indexAttribute,t=e.getAttribute(o);return t?parseInt(t,10):(console.warn(`Missing attribute name '${o}={index}' on measured element.`),-1)},this._measureElement=(e,o)=>{const t=this.measurementsCache[this.indexFromElement(e)];if(!t||!e.isConnected){this.measureElementCache.forEach((l,f)=>{l===e&&(this.observer.unobserve(e),this.measureElementCache.delete(f))});return}const a=this.measureElementCache.get(t.key);a!==e&&(a&&this.observer.unobserve(a),this.observer.observe(e),this.measureElementCache.set(t.key,e));const r=this.options.measureElement(e,o,this);this.resizeItem(t,r)},this.resizeItem=(e,o)=>{const t=this.itemSizeCache.get(e.key)??e.size,a=o-t;a!==0&&(e.start<this.scrollOffset+this.scrollAdjustments&&this._scrollToOffset(this.scrollOffset,{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(e.index),this.itemSizeCache=new Map(this.itemSizeCache.set(e.key,o)),this.notify(!1))},this.measureElement=e=>{e&&this._measureElement(e,void 0)},this.getVirtualItems=H(()=>[this.getIndexes(),this.getMeasurements()],(e,o)=>{const t=[];for(let a=0,r=e.length;a<r;a++){const l=e[a],f=o[l];t.push(f)}return t},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const o=this.getMeasurements();return se(o[we(0,o.length-1,t=>se(o[t]).start,e)])},this.getOffsetForAlignment=(e,o)=>{const t=this.getSize();o==="auto"&&(e<=this.scrollOffset?o="start":e>=this.scrollOffset+t?o="end":o="start"),o==="start"?e=e:o==="end"?e=e-t:o==="center"&&(e=e-t/2);const a=this.options.horizontal?"scrollWidth":"scrollHeight",l=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[a]:this.scrollElement[a]:0)-this.getSize();return Math.max(Math.min(l,e),0)},this.getOffsetForIndex=(e,o="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const t=se(this.getMeasurements()[e]);if(o==="auto")if(t.end>=this.scrollOffset+this.getSize()-this.options.scrollPaddingEnd)o="end";else if(t.start<=this.scrollOffset+this.options.scrollPaddingStart)o="start";else return[this.scrollOffset,o];const a=o==="end"?t.end+this.options.scrollPaddingEnd:t.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(a,o),o]},this.isDynamicMode=()=>this.measureElementCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&(clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:o="start",behavior:t}={})=>{this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,o),{adjustments:void 0,behavior:t})},this.scrollToIndex=(e,{align:o="auto",behavior:t}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const[a,r]=this.getOffsetForIndex(e,o);this._scrollToOffset(a,{adjustments:void 0,behavior:t}),t!=="smooth"&&this.isDynamicMode()&&(this.scrollToIndexTimeoutId=setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.measureElementCache.has(this.options.getItemKey(e))){const[f]=this.getOffsetForIndex(e,r);Je(f,this.scrollOffset)||this.scrollToIndex(e,{align:r,behavior:t})}else this.scrollToIndex(e,{align:r,behavior:t})}))},this.scrollBy=(e,{behavior:o}={})=>{this.cancelScrollToIndex(),o==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.scrollOffset+e,{adjustments:void 0,behavior:o})},this.getTotalSize=()=>{var e;const o=this.getMeasurements();let t;return o.length===0?t=this.options.paddingStart:t=this.options.lanes===1?((e=o[o.length-1])==null?void 0:e.end)??0:Math.max(...o.slice(-this.options.lanes).map(a=>a.end)),t-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(e,{adjustments:o,behavior:t})=>{this.options.scrollToFn(e,{behavior:t,adjustments:o},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(u),this.scrollRect=this.options.initialRect,this.scrollOffset=this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(e=>{this.itemSizeCache.set(e.key,e.size)}),this.maybeNotify()}}const we=(n,u,e,o)=>{for(;n<=u;){const t=(n+u)/2|0,a=e(t);if(a<o)n=t+1;else if(a>o)u=t-1;else return t}return n>0?n-1:0};function lt({measurements:n,outerSize:u,scrollOffset:e}){const o=n.length-1,a=we(0,o,l=>n[l].start,e);let r=a;for(;r<o&&n[r].end<e+u;)r++;return{startIndex:a,endIndex:r}}function nt(n){const u=new tt(S(n)),e=Me(u),o=u._didMount();return j(()=>S(n).getScrollElement(),t=>{t&&u._willUpdate()},{immediate:!0}),j(()=>S(n),t=>{u.setOptions({...t,onChange:(a,r)=>{var l;fe(e),(l=t.onChange)==null||l.call(t,a,r)}}),u._willUpdate(),fe(e)},{immediate:!0}),ze(o),e}function ot(n){return nt(y(()=>({observeElementRect:Ze,observeElementOffset:Qe,scrollToFn:et,...S(n)})))}var at={};function it(n,u){return n===u}var st=(n=>(n[n.Open=0]="Open",n[n.Closed=1]="Closed",n))(st||{}),rt=(n=>(n[n.Single=0]="Single",n[n.Multi=1]="Multi",n))(rt||{}),ut=(n=>(n[n.Pointer=0]="Pointer",n[n.Focus=1]="Focus",n[n.Other=2]="Other",n))(ut||{});let Te=Symbol("ComboboxContext");function Y(n){let u=Ce(Te,null);if(u===null){let e=new Error(`<${n} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,Y),e}return u}let Re=Symbol("VirtualContext"),dt=G({name:"VirtualProvider",setup(n,{slots:u}){let e=Y("VirtualProvider"),o=y(()=>{let l=T(e.optionsRef);if(!l)return{start:0,end:0};let f=window.getComputedStyle(l);return{start:parseFloat(f.paddingBlockStart||f.paddingTop),end:parseFloat(f.paddingBlockEnd||f.paddingBottom)}}),t=ot(y(()=>({scrollPaddingStart:o.value.start,scrollPaddingEnd:o.value.end,count:e.virtual.value.options.length,estimateSize(){return 40},getScrollElement(){return T(e.optionsRef)},overscan:12}))),a=y(()=>{var l;return(l=e.virtual.value)==null?void 0:l.options}),r=V(0);return j([a],()=>{r.value+=1}),Oe(Re,e.virtual.value?t:null),()=>[ee("div",{style:{position:"relative",width:"100%",height:`${t.value.getTotalSize()}px`},ref:l=>{if(l){if(typeof process<"u"&&at.JEST_WORKER_ID!==void 0||e.activationTrigger.value===0)return;e.activeOptionIndex.value!==null&&e.virtual.value.options.length>e.activeOptionIndex.value&&t.value.scrollToIndex(e.activeOptionIndex.value)}}},t.value.getVirtualItems().map(l=>Fe(u.default({option:e.virtual.value.options[l.index],open:e.comboboxState.value===0})[0],{key:`${r.value}-${l.index}`,"data-index":l.index,"aria-setsize":e.virtual.value.options.length,"aria-posinset":l.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${l.start}px)`,overflowAnchor:"none"}})))]}}),xe=G({name:"Combobox",emits:{"update:modelValue":n=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],nullable:!0,default:null},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1},immediate:{type:[Boolean],default:!1},virtual:{type:Object,default:null}},inheritAttrs:!1,setup(n,{slots:u,attrs:e,emit:o}){let t=V(1),a=V(null),r=V(null),l=V(null),f=V(null),h=V({static:!1,hold:!1}),p=V([]),m=V(null),d=V(2),C=V(!1);function R(s=v=>v){let v=m.value!==null?p.value[m.value]:null,b=s(p.value.slice()),x=b.length>0&&b[0].dataRef.order.value!==null?b.sort((k,A)=>k.dataRef.order.value-A.dataRef.order.value):Ue(b,k=>T(k.dataRef.domRef)),w=v?x.indexOf(v):null;return w===-1&&(w=null),{options:x,activeOptionIndex:w}}let M=y(()=>n.multiple?1:0),D=y(()=>n.nullable),[g,I]=$e(y(()=>n.modelValue),s=>o("update:modelValue",s),y(()=>n.defaultValue)),$=y(()=>g.value===void 0?W(M.value,{1:[],0:void 0}):g.value),c=null,E=null;function O(s){return W(M.value,{0(){return I==null?void 0:I(s)},1:()=>{let v=L(i.value.value).slice(),b=L(s),x=v.findIndex(w=>i.compare(b,L(w)));return x===-1?v.push(b):v.splice(x,1),I==null?void 0:I(v)}})}let z=y(()=>{});j([z],([s],[v])=>{if(i.virtual.value&&s&&v&&m.value!==null){let b=s.indexOf(v[m.value]);b!==-1?m.value=b:m.value=null}});let i={comboboxState:t,value:$,mode:M,compare(s,v){if(typeof n.by=="string"){let b=n.by;return(s==null?void 0:s[b])===(v==null?void 0:v[b])}return n.by===null?it(s,v):n.by(s,v)},calculateIndex(s){return i.virtual.value?n.by===null?i.virtual.value.options.indexOf(s):i.virtual.value.options.findIndex(v=>i.compare(v,s)):p.value.findIndex(v=>i.compare(v.dataRef.value,s))},defaultValue:y(()=>n.defaultValue),nullable:D,immediate:y(()=>!1),virtual:y(()=>null),inputRef:r,labelRef:a,buttonRef:l,optionsRef:f,disabled:y(()=>n.disabled),options:p,change(s){I(s)},activeOptionIndex:y(()=>{if(C.value&&m.value===null&&(i.virtual.value?i.virtual.value.options.length>0:p.value.length>0)){if(i.virtual.value){let v=i.virtual.value.options.findIndex(b=>{var x;return!((x=i.virtual.value)!=null&&x.disabled(b))});if(v!==-1)return v}let s=p.value.findIndex(v=>!v.dataRef.disabled);if(s!==-1)return s}return m.value}),activationTrigger:d,optionsPropsRef:h,closeCombobox(){C.value=!1,!n.disabled&&t.value!==1&&(t.value=1,m.value=null)},openCombobox(){if(C.value=!0,!n.disabled&&t.value!==0){if(i.value.value){let s=i.calculateIndex(i.value.value);s!==-1&&(m.value=s)}t.value=0}},setActivationTrigger(s){d.value=s},goToOption(s,v,b){C.value=!1,c!==null&&cancelAnimationFrame(c),c=requestAnimationFrame(()=>{if(n.disabled||f.value&&!h.value.static&&t.value===1)return;if(i.virtual.value){m.value=s===F.Specific?v:pe({focus:s},{resolveItems:()=>i.virtual.value.options,resolveActiveIndex:()=>{var k,A;return(A=(k=i.activeOptionIndex.value)!=null?k:i.virtual.value.options.findIndex(ae=>{var J;return!((J=i.virtual.value)!=null&&J.disabled(ae))}))!=null?A:null},resolveDisabled:k=>i.virtual.value.disabled(k),resolveId(){throw new Error("Function not implemented.")}}),d.value=b??2;return}let x=R();if(x.activeOptionIndex===null){let k=x.options.findIndex(A=>!A.dataRef.disabled);k!==-1&&(x.activeOptionIndex=k)}let w=s===F.Specific?v:pe({focus:s},{resolveItems:()=>x.options,resolveActiveIndex:()=>x.activeOptionIndex,resolveId:k=>k.id,resolveDisabled:k=>k.dataRef.disabled});m.value=w,d.value=b??2,p.value=x.options})},selectOption(s){let v=p.value.find(x=>x.id===s);if(!v)return;let{dataRef:b}=v;O(b.value)},selectActiveOption(){if(i.activeOptionIndex.value!==null){if(i.virtual.value)O(i.virtual.value.options[i.activeOptionIndex.value]);else{let{dataRef:s}=p.value[i.activeOptionIndex.value];O(s.value)}i.goToOption(F.Specific,i.activeOptionIndex.value)}},registerOption(s,v){let b=Pe({id:s,dataRef:v});if(i.virtual.value){p.value.push(b);return}E&&cancelAnimationFrame(E);let x=R(w=>(w.push(b),w));m.value===null&&i.isSelected(v.value.value)&&(x.activeOptionIndex=x.options.indexOf(b)),p.value=x.options,m.value=x.activeOptionIndex,d.value=2,x.options.some(w=>!T(w.dataRef.domRef))&&(E=requestAnimationFrame(()=>{let w=R();p.value=w.options,m.value=w.activeOptionIndex}))},unregisterOption(s,v){if(c!==null&&cancelAnimationFrame(c),v&&(C.value=!0),i.virtual.value){p.value=p.value.filter(x=>x.id!==s);return}let b=R(x=>{let w=x.findIndex(k=>k.id===s);return w!==-1&&x.splice(w,1),x});p.value=b.options,m.value=b.activeOptionIndex,d.value=2},isSelected(s){return W(M.value,{0:()=>i.compare(L(i.value.value),L(s)),1:()=>L(i.value.value).some(v=>i.compare(L(v),L(s)))})},isActive(s){return m.value===i.calculateIndex(s)}};je([r,l,f],()=>i.closeCombobox(),y(()=>t.value===0)),Oe(Te,i),Le(y(()=>W(t.value,{0:ne.Open,1:ne.Closed})));let P=y(()=>{var s;return(s=T(r))==null?void 0:s.closest("form")});return ue(()=>{j([P],()=>{if(!P.value||n.defaultValue===void 0)return;function s(){i.change(n.defaultValue)}return P.value.addEventListener("reset",s),()=>{var v;(v=P.value)==null||v.removeEventListener("reset",s)}},{immediate:!0})}),()=>{var s,v,b;let{name:x,disabled:w,form:k,...A}=n,ae={open:t.value===0,disabled:w,activeIndex:i.activeOptionIndex.value,activeOption:i.activeOptionIndex.value===null?null:i.virtual.value?i.virtual.value.options[(s=i.activeOptionIndex.value)!=null?s:0]:(b=(v=i.options.value[i.activeOptionIndex.value])==null?void 0:v.dataRef.value)!=null?b:null,value:$.value};return ee(re,[...x!=null&&$.value!=null?De({[x]:$.value}).map(([J,ke])=>ee(Ae,Be({features:Ne.Hidden,key:J,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:k,name:J,value:ke}))):[],oe({theirProps:{...e,...de(A,["by","defaultValue","immediate","modelValue","multiple","nullable","onUpdate:modelValue","virtual"])},ourProps:{},slot:ae,slots:u,attrs:e,name:"Combobox"})])}}}),ye=G({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:null}},emits:{change:n=>!0},setup(n,{emit:u,attrs:e,slots:o,expose:t}){var a;let r=(a=n.id)!=null?a:`headlessui-combobox-input-${ce()}`,l=Y("ComboboxInput"),f=y(()=>qe(T(l.inputRef))),h={value:!1};t({el:l.inputRef,$el:l.inputRef});function p(){l.change(null);let c=T(l.optionsRef);c&&(c.scrollTop=0),l.goToOption(F.Nothing)}let m=y(()=>{var c;let E=l.value.value;return T(l.inputRef)?typeof n.displayValue<"u"&&E!==void 0?(c=n.displayValue(E))!=null?c:"":typeof E=="string"?E:"":""});ue(()=>{j([m,l.comboboxState,f],([c,E],[O,z])=>{if(h.value)return;let i=T(l.inputRef);i&&((z===0&&E===1||c!==O)&&(i.value=c),requestAnimationFrame(()=>{var P;if(h.value||!i||((P=f.value)==null?void 0:P.activeElement)!==i)return;let{selectionStart:s,selectionEnd:v}=i;Math.abs((v??0)-(s??0))===0&&s===0&&i.setSelectionRange(i.value.length,i.value.length)}))},{immediate:!0}),j([l.comboboxState],([c],[E])=>{if(c===0&&E===1){if(h.value)return;let O=T(l.inputRef);if(!O)return;let z=O.value,{selectionStart:i,selectionEnd:P,selectionDirection:s}=O;O.value="",O.value=z,s!==null?O.setSelectionRange(i,P,s):O.setSelectionRange(i,P)}})});let d=V(!1);function C(){d.value=!0}function R(){ge().nextFrame(()=>{d.value=!1})}function M(c){switch(h.value=!0,c.key){case N.Enter:if(h.value=!1,l.comboboxState.value!==0||d.value)return;if(c.preventDefault(),c.stopPropagation(),l.activeOptionIndex.value===null){l.closeCombobox();return}l.selectActiveOption(),l.mode.value===0&&l.closeCombobox();break;case N.ArrowDown:return h.value=!1,c.preventDefault(),c.stopPropagation(),W(l.comboboxState.value,{0:()=>l.goToOption(F.Next),1:()=>l.openCombobox()});case N.ArrowUp:return h.value=!1,c.preventDefault(),c.stopPropagation(),W(l.comboboxState.value,{0:()=>l.goToOption(F.Previous),1:()=>{l.openCombobox(),Ee(()=>{l.value.value||l.goToOption(F.Last)})}});case N.Home:if(c.shiftKey)break;return h.value=!1,c.preventDefault(),c.stopPropagation(),l.goToOption(F.First);case N.PageUp:return h.value=!1,c.preventDefault(),c.stopPropagation(),l.goToOption(F.First);case N.End:if(c.shiftKey)break;return h.value=!1,c.preventDefault(),c.stopPropagation(),l.goToOption(F.Last);case N.PageDown:return h.value=!1,c.preventDefault(),c.stopPropagation(),l.goToOption(F.Last);case N.Escape:if(h.value=!1,l.comboboxState.value!==0)return;c.preventDefault(),l.optionsRef.value&&!l.optionsPropsRef.value.static&&c.stopPropagation(),l.nullable.value&&l.mode.value===0&&l.value.value===null&&p(),l.closeCombobox();break;case N.Tab:if(h.value=!1,l.comboboxState.value!==0)return;l.mode.value===0&&l.activationTrigger.value!==1&&l.selectActiveOption(),l.closeCombobox();break}}function D(c){u("change",c),l.nullable.value&&l.mode.value===0&&c.target.value===""&&p(),l.openCombobox()}function g(c){var E,O,z;let i=(E=c.relatedTarget)!=null?E:be.find(P=>P!==c.currentTarget);if(h.value=!1,!((O=T(l.optionsRef))!=null&&O.contains(i))&&!((z=T(l.buttonRef))!=null&&z.contains(i))&&l.comboboxState.value===0)return c.preventDefault(),l.mode.value===0&&(l.nullable.value&&l.value.value===null?p():l.activationTrigger.value!==1&&l.selectActiveOption()),l.closeCombobox()}function I(c){var E,O,z;let i=(E=c.relatedTarget)!=null?E:be.find(P=>P!==c.currentTarget);(O=T(l.buttonRef))!=null&&O.contains(i)||(z=T(l.optionsRef))!=null&&z.contains(i)||l.disabled.value||l.immediate.value&&l.comboboxState.value!==0&&(l.openCombobox(),ge().nextFrame(()=>{l.setActivationTrigger(1)}))}let $=y(()=>{var c,E,O,z;return(z=(O=(E=n.defaultValue)!=null?E:l.defaultValue.value!==void 0?(c=n.displayValue)==null?void 0:c.call(n,l.defaultValue.value):null)!=null?O:l.defaultValue.value)!=null?z:""});return()=>{var c,E,O,z,i,P,s;let v={open:l.comboboxState.value===0},{displayValue:b,onChange:x,...w}=n,k={"aria-controls":(c=l.optionsRef.value)==null?void 0:c.id,"aria-expanded":l.comboboxState.value===0,"aria-activedescendant":l.activeOptionIndex.value===null?void 0:l.virtual.value?(E=l.options.value.find(A=>!l.virtual.value.disabled(A.dataRef.value)&&l.compare(A.dataRef.value,l.virtual.value.options[l.activeOptionIndex.value])))==null?void 0:E.id:(O=l.options.value[l.activeOptionIndex.value])==null?void 0:O.id,"aria-labelledby":(P=(z=T(l.labelRef))==null?void 0:z.id)!=null?P:(i=T(l.buttonRef))==null?void 0:i.id,"aria-autocomplete":"list",id:r,onCompositionstart:C,onCompositionend:R,onKeydown:M,onInput:D,onFocus:I,onBlur:g,role:"combobox",type:(s=e.type)!=null?s:"text",tabIndex:0,ref:l.inputRef,defaultValue:$.value,disabled:l.disabled.value===!0?!0:void 0};return oe({ourProps:k,theirProps:w,slot:v,attrs:e,slots:o,features:le.RenderStrategy|le.Static,name:"ComboboxInput"})}}}),Se=G({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(n,{attrs:u,slots:e,expose:o}){let t=Y("ComboboxOptions"),a=`headlessui-combobox-options-${ce()}`;o({el:t.optionsRef,$el:t.optionsRef}),te(()=>{t.optionsPropsRef.value.static=n.static}),te(()=>{t.optionsPropsRef.value.hold=n.hold});let r=Ke(),l=y(()=>r!==null?(r.value&ne.Open)===ne.Open:t.comboboxState.value===0);return We({container:y(()=>T(t.optionsRef)),enabled:y(()=>t.comboboxState.value===0),accept(f){return f.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:f.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(f){f.setAttribute("role","none")}}),()=>{var f,h,p;let m={open:t.comboboxState.value===0},d={"aria-labelledby":(p=(f=T(t.labelRef))==null?void 0:f.id)!=null?p:(h=T(t.buttonRef))==null?void 0:h.id,id:a,ref:t.optionsRef,role:"listbox","aria-multiselectable":t.mode.value===1?!0:void 0},C=de(n,["hold"]);return oe({ourProps:d,theirProps:C,slot:m,attrs:u,slots:t.virtual.value&&t.comboboxState.value===0?{...e,default:()=>[ee(dt,{},e.default)]}:e,features:le.RenderStrategy|le.Static,visible:l.value,name:"ComboboxOptions"})}}}),Ie=G({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},order:{type:[Number],default:null}},setup(n,{slots:u,attrs:e,expose:o}){let t=Y("ComboboxOption"),a=`headlessui-combobox-option-${ce()}`,r=V(null);o({el:r,$el:r});let l=y(()=>{var g;return t.virtual.value?t.activeOptionIndex.value===t.calculateIndex(n.value):t.activeOptionIndex.value===null?!1:((g=t.options.value[t.activeOptionIndex.value])==null?void 0:g.id)===a}),f=y(()=>t.isSelected(n.value)),h=Ce(Re,null),p=y(()=>({disabled:n.disabled,value:n.value,domRef:r,order:y(()=>n.order)}));ue(()=>t.registerOption(a,p)),Ve(()=>t.unregisterOption(a,l.value)),te(()=>{let g=T(r);g&&(h==null||h.value.measureElement(g))}),te(()=>{t.comboboxState.value===0&&l.value&&(t.virtual.value||t.activationTrigger.value!==0&&Ee(()=>{var g,I;return(I=(g=T(r))==null?void 0:g.scrollIntoView)==null?void 0:I.call(g,{block:"nearest"})}))});function m(g){var I;if(n.disabled||(I=t.virtual.value)!=null&&I.disabled(n.value))return g.preventDefault();t.selectOption(a),He()||requestAnimationFrame(()=>{var $;return($=T(t.inputRef))==null?void 0:$.focus({preventScroll:!0})}),t.mode.value===0&&requestAnimationFrame(()=>t.closeCombobox())}function d(){var g;if(n.disabled||(g=t.virtual.value)!=null&&g.disabled(n.value))return t.goToOption(F.Nothing);let I=t.calculateIndex(n.value);t.goToOption(F.Specific,I)}let C=_e();function R(g){C.update(g)}function M(g){var I;if(!C.wasMoved(g)||n.disabled||(I=t.virtual.value)!=null&&I.disabled(n.value)||l.value)return;let $=t.calculateIndex(n.value);t.goToOption(F.Specific,$,0)}function D(g){var I;C.wasMoved(g)&&(n.disabled||(I=t.virtual.value)!=null&&I.disabled(n.value)||l.value&&(t.optionsPropsRef.value.hold||t.goToOption(F.Nothing)))}return()=>{let{disabled:g}=n,I={active:l.value,selected:f.value,disabled:g},$={id:a,ref:r,role:"option",tabIndex:g===!0?void 0:-1,"aria-disabled":g===!0?!0:void 0,"aria-selected":f.value,disabled:void 0,onClick:m,onFocus:d,onPointerenter:R,onMouseenter:R,onPointermove:M,onMousemove:M,onPointerleave:D,onMouseleave:D},c=de(n,["order","value"]);return oe({ourProps:$,theirProps:c,slot:I,attrs:e,slots:u,name:"ComboboxOption"})}}});function ct(n,u){const e=V(""),o=V(null),t=d=>u.completionFormatProposal?u.completionFormatProposal(d,u.id):d&&u.completionProp?d[u.completionProp]:null,a=d=>d?u.completionFormatSearch?u.completionFormatSearch(d,u.id):d:null,r=V([]),l=d=>{e.value=d,o.value=d,n("update:modelValue",o.value),d!==""&&p()},f=()=>{m(),axios.get(u.completionEndpoint,{params:u.completionParams(e.value,u.id)}).then(d=>{r.value=d.data.data})};let h=null;const p=()=>{m(),h=setInterval(()=>f(),500)},m=()=>{h&&(clearInterval(h),h=null)};return j(o,d=>{n("update:modelValue",o.value)}),j(()=>u.modelValue,d=>{n("update:error",""),e.value=d,o.value=d},{immediate:!0}),{selectedProposalValue:o,formatProposalValue:t,formatSearchValue:a,proposals:r,searchChanged:l}}const vt={key:0,class:"w-full"},ft={class:"flex select-none items-center pl-3 text-sm text-gray-500 dark:text-gray-200"},mt={key:1,class:"w-full p-0 bg-transparent border-0"},St={__name:"TextInputWithCompletion",props:{id:{type:String,required:!0},placeholder:{type:String,required:!1},modelValue:{type:String,required:!0},error:{type:String,required:!1},showError:{type:Boolean,default:!0},class:{type:String,required:!1},prefix:{type:String,required:!1},completionEndpoint:{type:String,required:!0},completionParams:{type:Function,required:!0},completionProp:{type:String,required:!1},completionFormatProposal:{type:Function,required:!1},completionFormatSearch:{type:Function,required:!1}},emits:["update:modelValue","update:error","apply"],setup(n,{emit:u}){const e=n,o=u,t=()=>e.class,{selectedProposalValue:a,formatProposalValue:r,formatSearchValue:l,proposals:f,searchChanged:h}=ct(o,e);return(p,m)=>n.prefix?(B(),Z("div",vt,[q("div",{class:U([t(),"flex w-full rounded-md focus-within:ring-2 focus-within:ring-inset ring-inset bg-white focus-within:ring-indigo-600 dark:bg-gray-800 dark:focus-within:ring-indigo-400",n.error&&n.showError?"ring-2 ring-red-500 dark:ring-red-400":"ring-1 ring-gray-300 dark:ring-gray-600"])},[q("span",ft,ie(n.prefix),1),Q(S(xe),{class:"relative w-full",as:"div",modelValue:S(a),"onUpdate:modelValue":m[2]||(m[2]=d=>he(a)?a.value=d:null)},{default:K(()=>[Q(S(ye),{id:n.id,name:n.id,placeholder:n.placeholder,class:"w-full block flex-1 border-0 bg-transparent py-1.5 pl-1 text-sm leading-6 focus:ring-0 text-gray-900 placeholder:text-gray-400 dark:text-gray-200 dark:placeholder:text-gray-500",onChange:m[0]||(m[0]=d=>S(h)(d.target.value)),onFocus:m[1]||(m[1]=d=>p.$emit("update:error","")),"display-value":S(l)},null,8,["id","name","placeholder","display-value"]),S(f).length>0?(B(),_(S(Se),{key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:K(()=>[(B(!0),Z(re,null,me(S(f),(d,C)=>(B(),_(S(Ie),{key:C,value:S(r)(d),as:"template"},{default:K(({active:R,selected:M})=>[q("li",{class:U(["relative cursor-default select-none py-2 pl-3 pr-9",R?"bg-gray-200 dark:bg-gray-300 dark:text-gray-900":"text-gray-900"])},[q("span",{class:U(["block truncate",M?"font-semibold":"font-normal"])},ie(S(r)(d)),3)],2)]),_:2},1032,["value"]))),128))]),_:1})):X("",!0)]),_:1},8,["modelValue"])],2),n.showError?(B(),_(ve,{key:0,error:n.error},null,8,["error"])):X("",!0)])):(B(),Z("div",mt,[Q(S(xe),{class:"relative",as:"div",modelValue:S(a),"onUpdate:modelValue":m[5]||(m[5]=d=>he(a)?a.value=d:null)},{default:K(()=>[Q(S(ye),{id:n.id,name:n.id,placeholder:n.placeholder,class:U([t(),"focus-within:z-10 block w-full rounded-md border-0 py-1.5 text-sm leading-6 text-gray-900 ring-inset placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 dark:bg-gray-800 dark:placeholder:text-gray-500 dark:text-gray-200 dark:focus:ring-indigo-400",n.error&&n.showError?"ring-2 ring-red-500 dark:ring-red-400":"ring-1 ring-gray-300 dark:ring-gray-600"]),onChange:m[3]||(m[3]=d=>S(h)(d.target.value)),onFocus:m[4]||(m[4]=d=>p.$emit("update:error","")),"display-value":S(l)},null,8,["id","name","placeholder","class","display-value"]),S(f).length>0?(B(),_(S(Se),{key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:K(()=>[(B(!0),Z(re,null,me(S(f),(d,C)=>(B(),_(S(Ie),{key:C,value:S(r)(d),as:"template"},{default:K(({active:R,selected:M})=>[q("li",{class:U(["relative cursor-default select-none py-2 pl-3 pr-9",R?"bg-gray-200 dark:bg-gray-300 dark:text-gray-900":"text-gray-900"])},[q("span",{class:U(["block truncate",M?"font-semibold":"font-normal"])},ie(S(r)(d)),3)],2)]),_:2},1032,["value"]))),128))]),_:1})):X("",!0)]),_:1},8,["modelValue"]),n.showError?(B(),_(ve,{key:0,error:n.error},null,8,["error"])):X("",!0)]))}};export{St as _};
