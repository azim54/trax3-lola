import{_ as F}from"./AccessLayout-C1y39Yor.js";import{f as M,h as N,o as m,c as p,d as r,u as s,w as f,F as g,Z as P,a as o,e as _,i as w,t as u,k as C}from"./app-BqYB4w7h.js";import{_ as j}from"./PrimaryButton-JrsBxlP3.js";import{r as S,a as H}from"./FormModal--OgS4LYv.js";import{r as L,_ as T}from"./ConfirmModal-DdIInXQ7.js";import{_ as n}from"./InputLabel-B012P3ON.js";import{_ as c}from"./TextInput-Bd33mpYb.js";import{_ as K}from"./Select-I1X3nauV.js";import{u as R}from"./CrudItems-BFkrHaNx.js";import{r as W}from"./PencilSquareIcon-CqSWVHZD.js";import"./AuthenticatedLayout-DmkbqqwL.js";import"./TopBar-CSycyVTE.js";import"./ApplicationLogo-CbRF8qXe.js";import"./form-BD1T68Go.js";import"./use-resolve-button-type-zbaL4VAc.js";import"./calculate-active-index-CJPhqQS-.js";import"./use-text-value-5zAQL0RU.js";import"./use-tree-walker-CEHhLUFs.js";import"./transition-CSxLRhS2.js";import"./disposables-CuHKeC00.js";import"./InputError-_zuJ5dV-.js";import"./NeutralBadge-Cx27iNjU.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ChevronUpDownIcon-BxOM5Ujt.js";import"./LoadItems-f7CjgfCr.js";const Z={class:"rounded-lg shadow-md bg-white dark:ring-0 dark:bg-gray-800"},q={class:"p-5 border-b-2 border-gray-200 dark:border-gray-700"},z={class:"-ml-4 -mt-2 flex flex-wrap items-center justify-between sm:flex-nowrap"},G=o("div",{class:"ml-4 mt-2 max-w-lg"},[o("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-gray-100"}," Databases "),o("p",{class:"mt-1 text-sm text-gray-500"}," DB connections are helpful to move xAPI data to external databases such as MongoDB, Elasticsearch and OpenSearch. ")],-1),J={class:"ml-4 mt-2 flex-shrink-0"},Q={key:0,class:"table-auto min-w-full divide-y divide-gray-300 dark:divide-gray-500"},X={class:"divide-y divide-gray-200 dark:divide-gray-700"},Y={class:"px-5 py-3"},ee={class:"text-sm font-medium text-gray-900 dark:text-gray-300"},te={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},se={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},oe={class:"px-5 py-3"},re={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},ae={class:"px-5 py-3"},le={class:"flex space-x-4 justify-end items-center"},ne={key:1,class:"px-5 py-3 text-sm text-gray-500 dark:text-gray-400"},ie={class:"px-6"},de={class:"mt-5 px-6"},me={class:"mt-5 px-6"},pe={class:"mt-5 px-6"},ue={class:"mt-5 px-6"},ce={class:"mt-5 px-6"},fe={class:"mt-5 px-6"},xe={class:"mt-5 px-6 text-xs text-gray-500 dark:text-gray-400"},ve={class:"mt-1 mb-2 list-disc list-inside"},Ke={__name:"DbConnections",setup(ye){const a=M({id:null,name:"",driver:"mongodb",host:"",database:"",username:"",password:"",prefix:""}),h=[{id:"mongodb",name:"MongoDB"},{id:"elasticsearch",name:"Elasticsearch"},{id:"opensearch",name:"OpenSearch"}],b=N(()=>a.driver=="mongodb"?"Collections":"Indices"),U=d=>h.find(e=>e.id==d).name,D=(d,e)=>e=="username"||e=="password"?"":["driver","host","database","prefix"].includes(e)?d.settings[e]:d[e]===void 0?null:d[e],{createItem:A,updateItem:I,confirmCreateOrUpdateItem:i,deleteItem:$,confirmDeleteItem:B,loadedItems:V,isProcessingItem:k,itemFormVisible:x,deleteItemModalVisible:v,itemFormErrors:l}=R({url:"/trax/api/gateway/front/connections/db"},a,{afterPropLoading:D}),O=["statements","activities","agents","activity_profiles","agent_profiles","states"];return(d,e)=>(m(),p(g,null,[r(s(P),{title:"DB Connections"}),r(F,{"side-menu-current":"DB Connections"},{default:f(()=>[o("div",Z,[o("div",q,[o("div",z,[G,o("div",J,[r(j,{onClick:s(A),class:"flex"},{default:f(()=>[r(s(S),{class:"w-5 h-5 mr-2"}),_(" Database ")]),_:1},8,["onClick"])])])]),s(V).length>0?(m(),p("table",Q,[o("tbody",X,[(m(!0),p(g,null,w(s(V),(t,y)=>(m(),p("tr",{key:y},[o("td",Y,[o("div",ee,u(t.name),1),o("div",te," Host(s): "+u(t.settings.host),1),o("div",se," Database: "+u(t.settings.database),1)]),o("td",oe,[o("div",re,u(U(t.settings.driver)),1)]),o("td",ae,[o("div",le,[r(s(W),{class:"w-5 h-5 hover:cursor-pointer text-indigo-500 hover:text-indigo-700 dark:text-fuchsia-400 dark:hover:text-fuchsia-500",onClick:E=>s(I)(t)},null,8,["onClick"]),r(s(L),{class:"w-5 h-5 hover:cursor-pointer text-indigo-500 hover:text-indigo-700 dark:text-fuchsia-400 dark:hover:text-fuchsia-500",onClick:E=>s($)(t)},null,8,["onClick"])])])]))),128))])])):(m(),p("div",ne," There is currently no DB connection. ")),r(H,{title:"Database",processing:s(k),modelValue:s(x),"onUpdate:modelValue":e[13]||(e[13]=t=>C(x)?x.value=t:null),onConfirm:s(i)},{default:f(()=>[o("div",ie,[r(n,{for:"name",value:"Name"}),r(c,{id:"name",placeholder:"My database",modelValue:a.name,"onUpdate:modelValue":e[0]||(e[0]=t=>a.name=t),error:s(l).name,"onUpdate:error":e[1]||(e[1]=t=>s(l).name=t),onApply:s(i),class:"mt-1"},null,8,["modelValue","error","onApply"])]),o("div",de,[r(n,{for:"driver",value:"Driver"}),r(K,{id:"driver",options:h,modelValue:a.driver,"onUpdate:modelValue":e[2]||(e[2]=t=>a.driver=t),class:"mt-1"},null,8,["modelValue"])]),o("div",me,[r(n,{for:"host",value:"Host"}),r(c,{id:"host",placeholder:"localhost",modelValue:a.host,"onUpdate:modelValue":e[3]||(e[3]=t=>a.host=t),error:s(l).host,"onUpdate:error":e[4]||(e[4]=t=>s(l).host=t),onApply:s(i),class:"mt-1"},null,8,["modelValue","error","onApply"])]),o("div",pe,[r(n,{for:"database",value:"Database"}),r(c,{id:"database",placeholder:"trax3",modelValue:a.database,"onUpdate:modelValue":e[5]||(e[5]=t=>a.database=t),error:s(l).database,"onUpdate:error":e[6]||(e[6]=t=>s(l).database=t),onApply:s(i),class:"mt-1"},null,8,["modelValue","error","onApply"])]),o("div",ue,[r(n,{for:"username",value:"Username"}),r(c,{id:"username",placeholder:a.id?"Only if you want to change it":"username",modelValue:a.username,"onUpdate:modelValue":e[7]||(e[7]=t=>a.username=t),error:s(l).username,"onUpdate:error":e[8]||(e[8]=t=>s(l).username=t),onApply:s(i),class:"mt-1"},null,8,["placeholder","modelValue","error","onApply"])]),o("div",ce,[r(n,{for:"password",value:"Password"}),r(c,{id:"password",type:"password",placeholder:a.id?"Only if you want to change it":"password",modelValue:a.password,"onUpdate:modelValue":e[9]||(e[9]=t=>a.password=t),error:s(l).password,"onUpdate:error":e[10]||(e[10]=t=>s(l).password=t),onApply:s(i),class:"mt-1"},null,8,["placeholder","modelValue","error","onApply"])]),o("div",fe,[r(n,{for:"prefix",value:b.value+" prefix"},null,8,["value"]),r(c,{id:"prefix",placeholder:"Keep it empty if don't need a prefix",modelValue:a.prefix,"onUpdate:modelValue":e[11]||(e[11]=t=>a.prefix=t),error:s(l).prefix,"onUpdate:error":e[12]||(e[12]=t=>s(l).prefix=t),onApply:s(i),class:"mt-1"},null,8,["modelValue","error","onApply"])]),o("div",xe,[r(n,{value:b.value},null,8,["value"]),o("ul",ve,[(m(),p(g,null,w(O,(t,y)=>o("li",{key:y},u(a.prefix?a.prefix+"_":"")+u(t)+"_[store] ",1)),64))]),_(" where [store] is the slug of the store the data belongs to. ")])]),_:1},8,["processing","modelValue","onConfirm"]),r(T,{title:"Delete connection",processing:s(k),modelValue:s(v),"onUpdate:modelValue":e[14]||(e[14]=t=>C(v)?v.value=t:null),onConfirm:s(B)},{default:f(()=>[_(" Are you sure you want to delete this connection? We will check if there are some jobs using this connection before deleting it. ")]),_:1},8,["processing","modelValue","onConfirm"])])]),_:1})],64))}};export{Ke as default};
