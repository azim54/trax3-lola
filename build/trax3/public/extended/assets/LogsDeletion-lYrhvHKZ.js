import{_ as w}from"./LogsLayout-DYikyiJe.js";import{g as f,o as _,c as g,d as n,u as r,w as s,F as I,Z as M,e as S,a,t as $,j as k}from"./app-BqYB4w7h.js";import{_ as m}from"./InputLabel-B012P3ON.js";import{_ as N}from"./TextInput-Bd33mpYb.js";import{_ as d}from"./Select-I1X3nauV.js";import{u as Y,_ as A}from"./JobsManagement-BhfjSFNe.js";import{_ as O}from"./JobLogs-CCjrTMq8.js";import{u as B}from"./Logging-B97tV0no.js";import"./AuthenticatedLayout-DmkbqqwL.js";import"./TopBar-CSycyVTE.js";import"./ApplicationLogo-CbRF8qXe.js";import"./form-BD1T68Go.js";import"./use-resolve-button-type-zbaL4VAc.js";import"./calculate-active-index-CJPhqQS-.js";import"./use-text-value-5zAQL0RU.js";import"./use-tree-walker-CEHhLUFs.js";import"./InputError-_zuJ5dV-.js";import"./NeutralBadge-Cx27iNjU.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ChevronUpDownIcon-BxOM5Ujt.js";import"./FormModal--OgS4LYv.js";import"./PrimaryButton-JrsBxlP3.js";import"./transition-CSxLRhS2.js";import"./disposables-CuHKeC00.js";import"./ConfirmModal-DdIInXQ7.js";import"./moment-Cl4UOzQZ.js";import"./PencilSquareIcon-CqSWVHZD.js";import"./DataPanel-eTawuoZh.js";import"./CrudItems-BFkrHaNx.js";import"./LoadItems-f7CjgfCr.js";import"./FilterItems-DtKLW4qf.js";const C={class:"px-6"},F={class:"mt-5 px-6"},H={class:"mt-5 px-6"},E={key:0,class:"mt-5 px-6"},T={class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},v="/trax/api/gateway/front/jobs/logs-deletion",Le={__name:"LogsDeletion",setup(W){const c={max_level:7,until:"now",until_date:"",store:null},{logLevelOptions:x}=B(),{localDateWithSeconds:p,formatIsoDate:V,untilOptions:b,untilNotice:L}=Y(),u=f([{id:null,name:"All stores"}]),j=t=>new Promise((e,l)=>{axios.get("/trax/api/gateway/front/stores").then(U=>{u.value=U.data.data.filter(i=>i.status==="ready").map(i=>({id:i.slug,name:i.name})),u.value.unshift({id:null,name:"All stores"}),e()})}),D=t=>{let e="";return t.settings.until=="date"&&(e="Until "+p(t.settings.until_date)),t.description=e,t},y=(t,e)=>e=="max_level"?t.settings.max_level:e=="until"?t.settings.until:e=="until_date"&&t.settings.until_date?p(t.settings.until_date):t[e]===void 0?null:t[e],P=(t,e)=>e=="until_date"&&t.until_date?V(t.until_date):t[e],o=f(null);return(t,e)=>(_(),g(I,null,[n(r(M),{title:"Logs Deletion"}),n(w,{"side-menu-current":"Logs Deletion"},{default:s(()=>[n(A,{endpoint:v,title:"Logs Deletion",jobProps:c,beforeItemLoading:j,afterItemLoading:D,afterPropLoading:y,beforePropPosting:P,onInit:e[5]||(e[5]=l=>o.value=l)},{description:s(()=>[S(" You can create jobs to delete logs. ")]),form:s(()=>[a("div",C,[n(m,{value:"Store"}),n(d,{id:"store",options:u.value,modelValue:o.value.form.store,"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.form.store=l),class:"mt-1"},null,8,["options","modelValue"])]),a("div",F,[n(m,{value:"Max. level"}),n(d,{id:"max_level",options:r(x),modelValue:o.value.form.max_level,"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.form.max_level=l),class:"mt-1"},null,8,["options","modelValue"])]),a("div",H,[n(m,{value:"Logs recorded until"}),n(d,{id:"until",options:r(b),modelValue:o.value.form.until,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.form.until=l),class:"mt-1"},null,8,["options","modelValue"])]),o.value.form.until=="date"?(_(),g("div",E,[n(m,{for:"until_date",value:"Date"}),n(N,{id:"until_date",placeholder:"YYYY-MM-DD HH:MM:SS",modelValue:o.value.form.until_date,"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.form.until_date=l),error:o.value.errors.until_date,"onUpdate:error":e[4]||(e[4]=l=>o.value.errors.until_date=l),onApply:o.value.createOrUpdate,class:"mt-1"},null,8,["modelValue","error","onApply"]),a("div",T,$(r(L)(o.value.form.until_date)),1)])):k("",!0)]),feedback:s(()=>[n(O,{job:o.value.job,endpoint:v},null,8,["job"])]),_:1})]),_:1})],64))}};export{Le as default};
