import{h as c,o as d,b as m,w as y,a as f,d as P,u as v,n as V,t as S,j as g,x as j,c as q,F as N,i as O,g as $,s as z}from"./app-BqYB4w7h.js";import{j as C,r as I,A as D,F as H,I as T}from"./ChevronUpDownIcon-BxOM5Ujt.js";import{_ as E}from"./TextInputWithCompletion-u-xIqChF.js";import{u as L}from"./StoreSelector-eCG8qd9a.js";const M={class:"relative"},G={class:"block truncate"},J={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2"},K={__name:"FieldOptions",props:{id:{type:String,required:!0},modelValue:{type:String,required:!0},options:{type:Array,required:!0},disabled:{type:Boolean,default:!1},right:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(l,{emit:h}){const b=l,r=h,a=c({get(){return b.options.find(p=>p.id===b.modelValue)},set(p){r("update:modelValue",p.id)}});return(p,n)=>(d(),m(v(T),{as:"div",modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=u=>a.value=u)},{default:y(()=>[f("div",M,[P(v(C),{class:V([l.disabled?"cursor-default":"cursor-pointer focus-within:z-10 focus:outline-none focus:ring-2 focus:ring-indigo-600 dark:focus:ring-indigo-400",l.right?"rounded-r-md":"rounded-l-md","relative w-full py-1.5 pl-3 pr-10 text-sm leading-6 text-left ring-1 ring-inset bg-white text-gray-900 ring-gray-300 dark:bg-gray-800 dark:text-gray-200 dark:ring-gray-600"])},{default:y(()=>[f("span",G,S(a.value.name),1),f("span",J,[l.disabled?g("",!0):(d(),m(v(I),{key:0,class:"h-5 w-5 text-gray-400","aria-hidden":"true"}))])]),_:1},8,["class"]),l.disabled?g("",!0):(d(),m(j,{key:0,"leave-active-class":"transition ease-in duration-100","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:y(()=>[P(v(D),{class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none text-sm"},{default:y(()=>[(d(!0),q(N,null,O(l.options,u=>(d(),m(v(H),{as:"template",key:u.id,value:u},{default:y(({active:i,selected:s})=>[f("li",{class:V([i?"bg-gray-200 dark:bg-gray-300 dark:text-gray-900":"text-gray-900","relative cursor-default select-none py-2 px-3"])},[f("span",{class:V([s?"font-semibold":"font-normal","block truncate"])},S(u.name),3)],2)]),_:2},1032,["value"]))),128))]),_:1})]),_:1}))])]),_:1},8,["modelValue"]))}},Q={class:"relative flex flex-grow items-stretch"},Z={__name:"AgentField",props:{modelValue:{type:Object,required:!1},rounded:{type:Boolean,default:!0},error:{type:String,required:!1},showError:{type:Boolean,default:!0}},emits:["update:modelValue","update:error","apply"],setup(l,{emit:h}){const{currentStore:b}=L(),r=l,a=h,p=[{id:"mbox",name:"Mbox"},{id:"openid",name:"OpenID"},{id:"account",name:"Account"}],n=$("mbox"),u=$(""),i=$("");z(()=>r.modelValue,e=>{e===null&&(u.value="",i.value="")});const s=c({get(){if(!r.modelValue)return n.value;if(r.modelValue.mbox)return n.value="mbox","mbox";if(r.modelValue.openid)return n.value="openid","openid";if(r.modelValue.account)return n.value="account","account"},set(e){n.value!=e&&(n.value=e,u.value="",i.value="",a("update:modelValue",null))}}),A=c({get(){return r.modelValue&&r.modelValue.mbox?r.modelValue.mbox.substring(7):""},set(e){e.trim()?a("update:modelValue",{mbox:"mailto:"+e.trim()}):a("update:modelValue",null)}}),F=c({get(){return r.modelValue&&r.modelValue.openid?r.modelValue.openid:""},set(e){e.trim()?a("update:modelValue",{openid:e.trim()}):a("update:modelValue",null)}}),U=c({get(){return r.modelValue&&r.modelValue.account?r.modelValue.account.name:u.value},set(e){u.value=e,e.trim()||i.value.trim()?a("update:modelValue",{account:{name:e.trim(),homePage:i.value.trim()}}):a("update:modelValue",null)}}),B=c({get(){return r.modelValue&&r.modelValue.account?r.modelValue.account.homePage:i.value},set(e){i.value=e,e.trim()||u.value.trim()?a("update:modelValue",{account:{name:u.value.trim(),homePage:e.trim()}}):a("update:modelValue",null)}}),w="/trax/api/gateway/front/stores/"+b()+"/agent-ids",x=(e,o)=>o=="agent"?{sort:["sid_field_1"],limit:10,filters:{sid_type:n.value,in_sid_field_1:e},distinct:["sid_field_1"]}:{sort:["sid_field_2"],limit:10,filters:{sid_type:n.value,in_sid_field_2:e},distinct:["sid_field_2"]},k=(e,o)=>n.value=="mbox"?e.sid_field_1.split("mailto:")[1]:o=="agent"?e.sid_field_1:e.sid_field_2;return(e,o)=>(d(),q(N,null,[P(K,{id:"agent-type",options:p,modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=t=>s.value=t)},null,8,["modelValue"]),f("div",Q,[s.value==="mbox"?(d(),m(E,{key:0,id:"agent",prefix:"mailto:",placeholder:"agent@email.test",class:V([l.rounded?"rounded-none rounded-r":"rounded-none"]),modelValue:A.value,"onUpdate:modelValue":o[1]||(o[1]=t=>A.value=t),error:l.error,showError:l.showError,"onUpdate:error":o[2]||(o[2]=t=>e.$emit("update:error",t)),onApply:o[3]||(o[3]=t=>e.$emit("apply")),completionEndpoint:w,completionParams:x,completionFormatProposal:k},null,8,["class","modelValue","error","showError"])):g("",!0),s.value==="openid"?(d(),m(E,{key:1,id:"agent",placeholder:"http://openid",class:V([l.rounded?"rounded-none rounded-r":"rounded-none"]),modelValue:F.value,"onUpdate:modelValue":o[4]||(o[4]=t=>F.value=t),error:l.error,showError:l.showError,"onUpdate:error":o[5]||(o[5]=t=>e.$emit("update:error",t)),onApply:o[6]||(o[6]=t=>e.$emit("apply")),completionEndpoint:w,completionParams:x,completionFormatProposal:k},null,8,["class","modelValue","error","showError"])):g("",!0),s.value==="account"?(d(),m(E,{key:2,id:"agent",placeholder:"name",class:"rounded-none",modelValue:U.value,"onUpdate:modelValue":o[7]||(o[7]=t=>U.value=t),error:l.error,showError:l.showError,"onUpdate:error":o[8]||(o[8]=t=>e.$emit("update:error",t)),onApply:o[9]||(o[9]=t=>e.$emit("apply")),completionEndpoint:w,completionParams:x,completionFormatProposal:k},null,8,["modelValue","error","showError"])):g("",!0),s.value==="account"?(d(),m(E,{key:3,id:"agent_homepage",placeholder:"http://homepage",class:V([l.rounded?"rounded-none rounded-r":"rounded-none"]),modelValue:B.value,"onUpdate:modelValue":o[10]||(o[10]=t=>B.value=t),error:l.error,showError:l.showError,"onUpdate:error":o[11]||(o[11]=t=>e.$emit("update:error",t)),onApply:o[12]||(o[12]=t=>e.$emit("apply")),completionEndpoint:w,completionParams:x,completionFormatProposal:k},null,8,["class","modelValue","error","showError"])):g("",!0)])],64))}};export{Z as _,K as a};
