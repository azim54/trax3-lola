import{_ as D}from"./PrimaryButton-JrsBxlP3.js";import{a as F,r as P}from"./FormModal--OgS4LYv.js";import{_ as S,r as U}from"./ConfirmModal-DdIInXQ7.js";import{_ as q}from"./AgentFilter-Bzph49mo.js";import{u as E}from"./XapiProps-BVq1ckif.js";import{u as T}from"./StoreSelector-eCG8qd9a.js";import{Q as z,f as A,g,o as l,c as n,a as e,u as r,j as f,F as G,i as J,d as c,w as h,t as m,b as L,e as I}from"./app-BqYB4w7h.js";import"./transition-CSxLRhS2.js";import"./calculate-active-index-CJPhqQS-.js";import"./form-BD1T68Go.js";import"./disposables-CuHKeC00.js";import"./AgentField-Cckzi0Yd.js";import"./ChevronUpDownIcon-BxOM5Ujt.js";import"./use-resolve-button-type-zbaL4VAc.js";import"./use-text-value-5zAQL0RU.js";import"./TextInputWithCompletion-u-xIqChF.js";import"./InputError-_zuJ5dV-.js";import"./use-tree-walker-CEHhLUFs.js";import"./InputLabel-B012P3ON.js";import"./moment-Cl4UOzQZ.js";const M={class:"relative overflow-hidden px-0 pb-1 rounded-lg bg-white shadow-md dark:ring-0 dark:bg-gray-800"},O={class:"flow-root"},Q={class:"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},R={class:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8"},X={class:"min-w-full divide-y divide-gray-300 dark:divide-gray-500"},H=e("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-gray-500 w-0"},"   ",-1),K=e("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-gray-500"}," Type ",-1),W=e("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-gray-500"}," ID / Name ",-1),Y={key:0,scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-gray-500"},Z={class:"divide-y divide-gray-200 dark:divide-gray-700"},ee={class:"pl-6 pr-3 py-4 text-sm text-center font-bold text-fuchsia-500 dark:text-orange-500"},te={class:"px-3 py-4"},se={class:"text-xs text-gray-500 dark:text-gray-400"},ae={class:"text-sm font-medium text-gray-900 dark:text-white"},oe={class:"px-3 py-4"},re={class:"text-xs text-gray-500 dark:text-gray-400"},le={class:"text-sm font-medium text-gray-900 dark:text-white"},ne={key:0,class:"px-5 py-4"},ie={class:"flex space-x-4 justify-end items-center"},de={key:0,class:"grid justify-items-end mt-5"},ce={class:"px-6"},De={__name:"PersonResults",props:{agent:{type:Object,required:!1},items:{type:Array,required:!0}},emits:["changed"],setup(p,{emit:C}){const y=z(),{currentStore:v}=T(),$=p,k=C,i=A({agent:null}),w=g(),s=g(!1),u=g(!1),d=g(!1),x=A({...i}),B=()=>{i.agent=null,x.agent="",u.value=!0},b=()=>{s.value=!0,axios.post("/trax/api/gateway/front/stores/"+v()+"/persons",[[...$.items,i.agent]]).then(a=>{s.value=!1,u.value=!1,k("changed")}).catch(a=>{s.value=!1,a.response&&a.response.status==400&&(x.agent="Invalid xAPI agent!")})},N=a=>{w.value=a,d.value=!0},j=()=>{s.value=!0,axios.post("/trax/api/gateway/front/stores/"+v()+"/persons",[[w.value]]).then(a=>{s.value=!1,d.value=!1,k("changed")}).catch(a=>{s.value=!1,d.value=!1})},{agentIdByJson:_}=E();return(a,o)=>(l(),n("div",null,[e("div",M,[e("div",O,[e("div",Q,[e("div",R,[e("table",X,[e("thead",null,[e("tr",null,[H,K,W,r(y).props.auth.role!=="analyst"?(l(),n("th",Y,"   ")):f("",!0)])]),e("tbody",Z,[(l(!0),n(G,null,J(p.items,(t,V)=>(l(),n("tr",{key:V},[e("td",ee,m(V+1),1),e("td",te,[e("div",se,m(t.sid_type),1),e("div",ae,m(t.is_group?"Group":"Agent"),1)]),e("td",oe,[e("div",re,m(r(_)(t)),1),e("div",le,m(t.name?t.name:""),1)]),r(y).props.auth.role!=="analyst"?(l(),n("td",ne,[e("div",ie,[p.agent!==null&&r(_)(p.agent)!==r(_)(t)?(l(),L(r(U),{key:0,class:"w-5 h-5 hover:cursor-pointer text-indigo-500 hover:text-indigo-700 dark:text-fuchsia-400 dark:hover:text-fuchsia-500",onClick:me=>N(t)},null,8,["onClick"])):f("",!0)])])):f("",!0)]))),128))])])])])])]),r(y).props.auth.role!=="analyst"?(l(),n("div",de,[c(D,{class:"flex",onClick:B},{default:h(()=>[c(r(P),{class:"w-5 h-5 mr-2"}),I(" Add Agent ")]),_:1})])):f("",!0),c(F,{size:"xl",title:"Attach Agent",processing:s.value,modelValue:u.value,"onUpdate:modelValue":o[2]||(o[2]=t=>u.value=t),onConfirm:b},{default:h(()=>[e("div",ce,[c(q,{modelValue:i.agent,"onUpdate:modelValue":o[0]||(o[0]=t=>i.agent=t),error:x.agent,"onUpdate:error":o[1]||(o[1]=t=>x.agent=t),onApply:b,inline:!1},null,8,["modelValue","error"])])]),_:1},8,["processing","modelValue"]),c(S,{title:"Detach Agent",processing:s.value,modelValue:d.value,"onUpdate:modelValue":o[3]||(o[3]=t=>d.value=t),onConfirm:j},{default:h(()=>[I(" Are you sure you want to detach this agent from the displayed person? ")]),_:1},8,["processing","modelValue"])]))}};export{De as default};
