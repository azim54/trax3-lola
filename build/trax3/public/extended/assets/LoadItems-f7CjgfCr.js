import{g as f,f as b}from"./app-BqYB4w7h.js";function j(s,o={}){const m=f(0),i=f([]),g=f(!1),l=f(!1),c=s.filters?b({...s.filters}):b({}),n=s.baseParams&&s.baseParams.limit?s.baseParams.limit:20;let r={options:{},filters:{}};const v=e=>{e!==void 0&&(r=e),u()},L=()=>{u(!0)},u=(e=!1)=>{l.value=!0;let a=typeof s.url=="function"?s.url():s.url;axios.get(a,{params:p(e)}).then(t=>{l.value=!1,m.value++;const P=t.data.data.map(I=>o.afterItemLoading?o.afterItemLoading(I):I);e?i.value.push(...P):i.value=P,g.value=E(t.data.data),o.afterItemsLoading&&o.afterItemsLoading(i.value)}).catch(t=>{l.value=!1,m.value++,t.response&&t.response.status==422&&d(t.response.data)})},d=e=>{Object.keys(e.errors).forEach(a=>{c[a]=e.errors[a][0]})},p=e=>{let a={limit:n,filters:{},options:{}};if(s.baseParams&&s.baseParams.filters&&(a.filters={...s.baseParams.filters}),s.baseParams&&s.baseParams.options&&(a.options={...s.baseParams.options}),s.settings&&s.settings.sortProp&&(a.sort=r.options.ascending||s.settings.ascending?[s.settings.sortProp]:["-"+s.settings.sortProp]),e&&s.settings&&s.settings.more){let t={};t[s.settings.sortProp]=i.value.slice(-1).pop()[s.settings.sortProp],r.options.ascending||s.settings.ascending?a.after=t:a.before=t}return a.filters=Object.assign(a.filters,r.filters),a.options=Object.assign(a.options,r.options),delete a.options.ascending,a},E=e=>s.settings&&s.settings.more&&(r.options.ascending||e.length==n);return{loadItems:v,loadMoreItems:L,loadedCounter:m,loadedItems:i,loadingErrors:c,hasMoreItems:g,loadingItems:l}}export{j as u};
